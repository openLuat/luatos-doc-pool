# 合宙不同模组功耗对比

## 一、小数据量实时在线的功耗

   小数据量通信，低频次传输，但是又需要实时在线，方便手机或者其他上位机方便的控制物联网设备。

   本章描述的是，基于实网环境下，每次通信100个字节， 为了保持TCP连接不断链，几分钟和服务器通信一次。


### 1、测试条件

    - 1， 供电电压：      3.8V；
    - 2， IO电平设置：   1.8V；
    - 3， 固件版本： 截止到2024年9月30日的最新LuatOS固件；
    - 4， 测试服务器：    airtest.openluat.com, "2901"，回环测试；
    - 5， 每次心跳的通信内容：  10字节字符串： "0123456789"，    循环10次，一共 100字节；
    - 6，  驻网频段与驻网小区ID：   B3频段，小区id：  153708387；
        其他频段的功耗，会略有差异，但是对于小数据量的传输场景来说，差异不会特别的大。
    - 7，  UART1串口波特率：         9600；
    - 8，  信号强度：         实网环境， RSRP[-86，-88]之间；
    - 9， 测试硬件：    合宙Air780E/Air780EQ/Air780EP/Air780EPS/Air700ECQ，通用全IO开发板，2.1版本。
          删除了可能产生耗电的外设，比如 LED状态灯。
 

### 2、影响实网功耗的主要网络因素

在实网，实时在线，小数据量传输场景下，影响功耗的因素有很多，按照影响力从大到小排序， 分别是：

#### （1）心跳间隔时间

    在蜂窝通信的场景下，为了保持终端和服务器之间的TCP链接不断，
    
    要定时和服务器之间有心跳包的通信。
    
    这个心跳包的定时间隔，根据多年经验，不能低于5分钟。

    在不大于5分钟的条件下， 心跳包间隔越长， 功耗越低。

#### （2）实网信号强度
    终端的4G信号强度越好， 说明跟基站通信越容易。
    
    因此终端就不需要用特别大的功率和基站通信，因此功耗就会比较低。

    信号强度越差， 终端就需要用比较大的功率和基站通信，发射的功耗就会上升很多。

    本文的测试数据， 是基于信号强度良好的情况下测试出来的，
    
    这符合中国的4G信号的普遍情况。

    如果你的设备是在地下室，偏远地区这些信号比较弱的场景， 
    
    那么实际的设备的功耗，会上升一些。

#### （3）网络配置的 DRX 参数
    在终端注册到4G网络后，网络会根据网络自身的负载情况，下发一个DRX参数。
    
    这个DRX参数的大概意思是，终端多长时间醒过来去查询一下无线信道，
    
    看看网络有没有发什么通知给到终端。
    
    DRX 参数越小，代表终端就会更频繁的去查询是否有网络来的通知，功耗就会越大。

    DRX 参数是网络配置的，终端无法控制。
    
    所以，我们就分别测试了所有的三种 DRX 参数的功耗，让大家有个基本的认识。

    DRX 的三个参数分别为： 0.64秒，1.28秒，2.56秒，
    
    下文分别记为 快速监听，中速监听，慢速监听。
    
    这是我们自己发明的词汇，其他地方看不到，只是作为一个称谓，没有其他的含义。


#### （4）终端注册到4G的不同频段。
    国内的4G网络，有如下几个：
   
    B1，B3，B5，B8，B34，B38，B39，B40，B41。
   
    终端会根据信号强度的不同，选择一个信号最好的频段去驻留。
   
    本文给出的数据， 是终端驻留到 B3 的数据。
   
    其他的频段的功耗数据会略有差异，对于小数据量通信的场景，差异不会很大。


### 3，TCP心跳5分钟的功耗数据

    以下的数据， 都是按照快速监听，中速监听，慢速监听的三个数据的次序来排列。

#### （1）780EPS
    0.73 毫安，  0.56 毫安，0.33 毫安；
     转换成毫瓦为：
    2.77 毫瓦，  2.13毫瓦，  1.25毫瓦；

#### （2）780EP
    0.88 毫安，  0.52 毫安，0.38 毫安；
    3.34 毫瓦，  1.98毫瓦，  1.44毫瓦；

#### （3）780E和780EX
    0.96 毫安，  0.59 毫安，0.46 毫安；
    3.65 毫瓦，  2.24毫瓦，  1.75毫瓦；

#### （4）780EQ，700ECQ，700EAQ，700EMQ，780EEN，700EEU
    1.07毫安，   0.93毫安， 0.51毫安。
    4.07 毫瓦，  3.53毫瓦，  1.94毫瓦；



### 4，TCP心跳1分钟的功耗数据
    以下的数据， 都是按照快速监听，中速监听，慢速监听的三个数据的次序来排列。

#### （1）780EPS
    1.32 毫安，  1.07 毫安，0.82 毫安；
     转换成毫瓦为：
    5.02 毫瓦，  4.07毫瓦，  3.12毫瓦；

#### （2）780EP
    1,73 毫安，  1.38 毫安，1.06 毫安；
    6.57 毫瓦，  5.24毫瓦，  4.03毫瓦；

#### （3）780E和780EX
    1.76 毫安，  1.54 毫安，0.86 毫安；
    6.69 毫瓦，  5.85毫瓦，  3.27毫瓦；

#### （4）780EQ，700ECQ，700EAQ，700EMQ，780EEN，700EEU
    1.65毫安，   1.62毫安， 1.00毫安。
    6.27 毫瓦，  6.16毫瓦， 3.80毫瓦；


## 二、长时间休眠低频次唤醒的功耗

   在某些场景下，模组绝大多数时间深度休眠状态， 几个小时醒过来一次，
   
   向服务器端发送报文，然后继续深度休眠。

   由于不存在TCP链接， 所以服务器端无法主动向终端发送消息。

   服务器只能等待终端主动通信， 再通过回复消息，对终端做控制和参数配置。

   所以无法实现对终端的实时控制。

   这时候，模组的平均功耗，是非常低的，只有几个微安。


### 1，测试条件

    - 1， 供电电压：      3.8V；
    - 2， IO电平设置：   1.8V；
    - 3， 固件版本： 截止到2024年9月30日的最新LuatOS固件；
    - 4， 测试服务器：    airtest.openluat.com, "2901"，回环测试；
    - 5， 每次终端醒来通信的内容：  
         10字节字符串： "0123456789"，    循环10次，一共 100字节；
    - 6，  驻网频段与驻网小区ID：   B3频段，小区id：  153708387；
        其他频段的功耗，会略有差异，但是对于小数据量的传输场景来说，差异不会特别的大。
    - 7，  UART1串口波特率：         9600；
    - 8，  信号强度：         实网环境， RSRP[-86，-88]之间；
    - 9， 测试硬件：    合宙Air780E/Air780EQ/Air780EP/Air780EPS/Air700ECQ，通用全IO开发板，2.1版本。
          删除了可能产生耗电的外设，比如 LED状态灯。
 

### 2，影响实网功耗的主要网络因素

在非实时在线，深度休眠，定时醒来通信的通信场景下，影响功耗的因素，按照影响力从大到小排序， 分别是：

#### （1）定时醒来的间隔时间

    深度休眠的功耗非常低，只有几个微安。

    醒来通信的功耗相比深度休眠，功耗高了至少百倍。

    所以，醒过来的频次越低，总体功耗就越低。

    醒来的频次越高， 总体功耗就越高。


#### （2）实网信号强度
    终端的4G信号强度越好， 说明跟基站通信越容易。
    
    因此终端就不需要用特别大的功率和基站通信，因此功耗就会比较低。

    信号强度越差， 终端就需要用比较大的功率和基站通信，发射的功耗就会上升很多。

    本文的测试数据， 是基于信号强度良好的情况下测试出来的，
    
    这符合中国的4G信号的普遍情况。

    如果你的设备是在地下室，偏远地区这些信号比较弱的场景， 
    
    那么实际的设备的功耗，会上升一些。

    定时醒来的越频繁， 信号强度对功耗的影响越大；

    如果一天只醒来一次， 功耗的消耗主要是休眠的功耗消耗，信号强度对功耗的影响就没那么大了。


### 3，各个模组的深度休眠定时醒来通信的功耗数据

    以下的数据，醒来发送数据的时间间隔按照 1小时，4小时，12，24小时的测试数据来呈现。

#### （1）780EPS
    34 微安，  26 微安，7.5微安，5.86微安；
 转换成毫瓦为：
    130 微瓦，  99微瓦，  29微瓦， 22微瓦；

#### （2）780EP
    待测试；

#### （3）780E和780EX
    待测试；

#### （4）780EQ，700ECQ，700EAQ，700EMQ，780EEN，700EEU
    待测试；





