## 下载文件并保存到文件系统中：AT+FTPGETTOFS

语法规则：

| 命令类型 | 语法                                                         | 返回                                               |      |
| -------- | ------------------------------------------------------------ | -------------------------------------------------- | ---- |
| 设置命令 | AT+FTPGETTOFS=<loc>,<filename>[,<num>,<time>]                | OK                                                 | 成功 |
|          |                                                              | ERROR                                              | 失败 |
| 查询命令 | AT+FTPGETTOFS?                                               | +FTPGETTOFS: <status>[,<rcvlen>,<writelen>] <br>OK |      |
| URC上报  | +FTPGETTOFS:0,<totalLength>                                  | 如果下载成功                                       |      |
|          | +FTPGETTOFS:<error>                                          | 如果下载失败                                       |      |
| 测试命令 | AT+FTPGETTOFS=?                                              | OK                                                 |      |
| 注意事项 | 重连以后会断点续传<br>如果两次下载都用同一个文件名，上次下载的内容会被覆盖 |                                                    |      |

 

 

参数定义：

| 参数          | 定义                       | 取值  | 对取值的说明                         |
| ------------- | -------------------------- | ----- | ------------------------------------ |
| <status>      | 工作模式                   | 0     | 不在FTPGETTOFS过程                   |
|               |                            | 1     | 处于FTPGETTOFS过程                   |
| <loc>         | 文件保存的位置。           | 0     | 保存于ROM，文件夹固定为"C:/USER/FTP" |
| <filename>    | 文件名                     |       | 字符串型，最长64个字符               |
| <num>         | 自动重连次数               | 0-255 | 缺省值：3                            |
| <time>        | 等多少秒开始自动重连       | 0-60  | 单位：秒，缺省值：5                  |
| <rcvlen>      | 当前从FTP服务器GET多少数据 |       |                                      |
| <writelen>    | 当前保存到文件系统多少数据 |       |                                      |
| <totalLength> | 总共保存到文件系统多少数据 |       |                                      |
| <error>       | 错误码                     |       | 与AT+FTPGET命令的<error>定义相同     |
