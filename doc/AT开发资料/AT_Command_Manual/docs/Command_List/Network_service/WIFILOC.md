## 读取WIFI定位信息和时间：AT+WIFILOC

语法规则：

| 命令类型 | 语法                               | 返回                                                         |
| -------- | ---------------------------------- | ------------------------------------------------------------ |
| 设置命令 | `AT+WIFILOC=<type>,<cid>[,<mode>]` | **If `<type>`=1:** <br>`+WIFILOC:<locationcode>[,<latitude>,<longitude>,<date>,<time>]`  <br>OK <br>**If `<type>`=2:** <br>`+WIFILOC: <locationcode>[,<date>,<time>] `<br> OK  <br>**If error is related to ME functionality:** <br>`+CME ERROR: <err>` |
| 测试命令 | AT+WIFILOC=?                       | `+WIFILOC:(list of supported <type>s),(range of <cid>) `<br>OK |

 

参数定义：

| 参数             | 定义                                                         | 取值  | 对取值的说明          |
| ---------------- | ------------------------------------------------------------ | ----- | --------------------- |
| `<type >`        | 操作类型                                                     | 1     | 查看精度、维度和时间  |
|                  |                                                              | 2     | 只查看时间            |
| `<cid>`          | as `<cid>` defined in +SAPBR                                 | 1-3   |                       |
| `<mode>`         | 扫描优先级(默认数据优先)<br>注：本命令EC618平台系列模块（Air780E系列）软件版本>=V1143版本支持 | 0     | 数据优先              |
|                  |                                                              | 1     | wifi扫描优先          |
| `<longitude>`    | 当前经度(以度为单位)                                         |       | 经度(小数点后保留7位) |
| `<latitude>`     | 当前纬度，以度表示                                           |       | 纬度(小数点后保留7位) |
| `<date>`         | 格式为 yy/mm/dd                                              |       | 例如2023/11/08        |
| `<time>`         | 格式为 hh:mm:ss                                              |       | 例如15:47:26          |
| `<locationcode>` |                                                              | 0     | 成功                  |
|                  |                                                              | 1     | 未找到数据            |
|                  |                                                              | 2     | 权限错                |
|                  |                                                              | 6     | 参数错误              |
|                  |                                                              | 4或7  | 未知错误              |
|                  |                                                              | 255   | wifi成功              |
|                  |                                                              | 404   | 未找到                |
|                  |                                                              | 408   | 请求超时              |
|                  |                                                              | 601   | 网络错误              |
|                  |                                                              | 602   | 内存不足              |
|                  |                                                              | 603   | DNS错误               |
|                  |                                                              | 604   | 堆栈忙                |
|                  |                                                              | 65535 | 其它错误              |

 

举例:

| 命令（→）/返回（←） | 实例                                                         | 解释和说明                                                   |
| ------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| →                   | AT+SAPBR=3,1,"CONTYPE","GPRS"                                | 设置承载类型为GPRS                                           |
| ←                   | OK                                                           |                                                              |
| →                   | AT+SAPBR=3,1,"APN",""                                        | 设置PDP承载之APN参数 <br>模块注册网络后会从网络自动获取`<apn>`并激活一个PDP上下文，用于RNDIS上网使用（此`<apn>`可以通过AT+CGDCONT?来查询），所以输入AT+SAPBR=3,`<cid>`,"APN","" 即可，模块内部会按照自动获取的`<apn>`来设置APN |
| ←                   | OK                                                           |                                                              |
| →                   | AT+SAPBR=1,1                                                 | 激活GPRS PDP上下文                                           |
| ←                   | OK                                                           |                                                              |
| →                   | AT+SAPBR=2,1                                                 | 查询是否激活                                                 |
| ←                   | +SAPBR: 1,1,010.169.179.213 <br>OK                           | 返回中有IP地址表明激活成功                                   |
| →                   | AT+WIFILOC=1,1                                               | 查询位置和时间（超时时间40S）                                |
| ←                   | +WIFILOC: 0,034.7983328,114.3214505,2023/06/05,14:40:32<br> OK |                                                              |
| →                   | AT+WIFILOC=2,1                                               | 只查询时间                                                   |
| ←                   | +WIFILOC: 0,2023/06/05,14:40:32 <br>OK                       |                                                              |
| →                   | AT+SAPBR=0,1                                                 | 去激活PDP上下文                                              |
| ←                   | OK                                                           |                                                              |
