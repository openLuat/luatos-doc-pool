## 同步网络时间：AT+CNTP

| 命令类型 | 语法                                                     | 返回                                                 |
| -------- | -------------------------------------------------------- | ---------------------------------------------------- |
| 设置命令 | `AT+CNTP=<NTP server>[,<time zone>]`                     | OK                                                   |
| 执行命令 | AT+CNTP                                                  | OK <br>`+CNTP: <code>`                               |
| 查询命令 | AT+CNTP?                                                 | `+CNTP: <NTP server>,<time zone>，<time out>`<br> OK |
| 测试命令 | AT+CNTP=?                                                | OK                                                   |
| 注意事项 | 网络时间同步成功后，可以用AT+CCLK?命令来查询模块当前时间 |                                                      |

 

参数定义：

| 参数           | 定义      | 取值         | 对取值的说明                                                 |
| -------------- | --------- | ------------ | ------------------------------------------------------------ |
| `<NTP server>` | NTP服务器 | 域名或ip地址 |                                                              |
| `<time zone>`  | 本地时区  | -47~+48      | 单位：1/4时区。时区是-12~+12，但是有的国家会用半时区，甚至1/4时区，为兼顾这些国家，时区单位为：1/4时区。负号表示是西时区，正号表示为东时区 |
| `<code>`       | 操作码    | 1            | 网络时间同步成功                                             |
|                |           | 61           | 网络错误                                                     |
|                |           | 62           | DNS解析错误                                                  |
|                |           | 63           | 连接错误                                                     |
|                |           | 64           | 服务响应错误                                                 |
|                |           | 65           | 服务响应超时                                                 |
| `<time out>`   | 超时时间  |              | 单位为秒，若未设置默认5秒                                    |

 

举例：

| 命令（→）/返回（←） | 实例                                 | 解释和说明                                                   |
| ------------------- | ------------------------------------ | ------------------------------------------------------------ |
| →                   | AT+SAPBR=3,1,"Contype","GPRS"        | 激活PDP是使用CNTP命令同步时间的前提                          |
| ←                   | OK                                   |                                                              |
| →                   | AT+SAPBR=3,1,"APN",""                | 设置PDP承载之APN参数 模块注册网络后会从网络自动获取`<apn>`并激活一个PDP上下文，用于RNDIS上网使用（此`<apn>`可以通过AT+CGDCONT?来查询），所以输入AT+SAPBR=3,`<cid>`,"APN","" 即可，模块内部会按照自动获取的`<apn>`来设置APN |
| ←                   | OK                                   |                                                              |
| →                   | AT+SAPBR=1,1                         | 激活`<cid>`=1的PDP                                           |
| ←                   | OK                                   |                                                              |
| →                   | AT+CNTPCID=1                         | 设置使用的PDP的`<cid>`=1                                     |
| ←                   | OK                                   |                                                              |
| →                   | AT+CNTP                              |                                                              |
| ←                   | OK +CNTP:1                           |                                                              |
| →                   | AT+CCLK?                             |                                                              |
| ←                   | +CCLK: "18/05/16,15:49:28+32" <br>OK |                                                              |
